<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="../css/screen.css" />
  <link rel="icon" href="../favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="../favicon.ico" type=
  "image/x-icon" />

  <title>Ruby Tutorial</title>
</head>

<body>
<div id="content">
  <h1><a name="rubytut_top" id="rubytut_top">Ruby Tutorial</a> <span class="version_alert">Komodo IDE only</span></h1>

  <h2><a name="rubytut_overview" id=
  "rubytut_overview">Overview</a></h2>

  <h3><a name="rubytut_assumptions" id="rubytut_assumptions">Before
  You Start</a></h3>

  <p>This tutorial assumes:</p>

  <ul>
    <li><a class="doc" href=
    "http://ruby-lang.org/en/20020102.html">Ruby 1.8.0</a> or
    greater is installed on your system. See the <a
    href="../debugruby.html#debugruby_top">Debugging Ruby</a>
    documentation for configuration instructions.</li>

    <li>You are interested in learning about Komodo functionality,
    including the debugger.</li>

    <li>You are interested in Ruby and have some programming
    experience either in Ruby or another language.</li>
  </ul>

  <h3><a name="rubytut_scenario" id="rubytut_scenario">Ruby
  Tutorial Scenario</a></h3>

  <p>The Ruby Tutorial demonstrates how to use Komodo to write and
  debug a simple Ruby program which saves its data in a YAML file.
  In this tutorial you will:</p>

  <ol>
    <li><a class="doc" href="#rubytut_open"><strong>Open the Ruby
    Tutorial Project</strong></a>.</li>

    <li><a class="doc" href=
    "#rubytut_analyze"><strong>Analyze
    menagerie.rb</strong></a> the Ruby program included in the
    Tutorial Project.</li>

    <li><a class="doc" href="#rubytut_run"><strong>Run the
    program</strong></a> in Komodo.</li>

    <li><a class="doc" href="#rubytut_debug"><strong>Debug the
    program</strong></a> using the Komodo debugger.</li>
  </ol>

  <p>See <a class="doc" href=
  "../debugger.html#debugger_top">Debugging Programs</a>
  for more information on debugging in Komodo.</p>

  <h2><a name="rubytut_open" id="rubytut_open">Opening the Tutorial
  Project</a></h2>

  <p>On the <strong>Start Page</strong> under <strong>Tutorials and
  Documentation</strong>, click <strong>Ruby Tutorial</strong>, or open
  the <em>ruby_tutorial.kpf</em> file from the
  <em>samples/ruby_tutorials</em> subdirectory of Komodo's <a
  href="../trouble.html#appdata_dir">user data directory</a></p>
  
  <p>The tutorial project will open in the <a class="doc" href=
  "../workspace.html#places_sidebar">Places sidebar</a>.</p>

  <h3><a name="rubytut_files" id="rubytut_files">Overview of the
  Tutorial Files</a></h3>

  <p>The <em>ruby_tutorial</em> project contains:</p>

  <ul>
    <li><strong>menagerie.rb</strong>: A program which stores and
    retrieves information on animals.</li>

    <li><strong>animals.yaml</strong>: A YAML data file containing
    a base list of animals.</li>

    <li><strong>check_fname</strong>: A code snippet that can be
    added to the program.</li>
  </ul>

  <h3><a name="rubytut_openfile" id="rubytut_openfile">Open the
  Ruby Tutorial File</a></h3>

  <p>In the <a class="doc" href=
  "../workspace.html#places_sidebar">Places sidebar</a>,
  double-click the <em>menagerie.rb</em> file. This file opens in
  the Editor Pane; a tab at the top of the pane displays the
  filename.</p>

  <h2><a name="rubytut_analyze" id="rubytut_analyze">Analyzing the
  Ruby program</a></h2>

  <p>The <em>menagerie.rb</em> program is a simple interactive
  program that can add, list, and search for information about
  animals. It can also store this information in a YAML file (e.g.
  <em>animals.yaml</em>). It is essentially an extremely simple
  database with predefined fields.</p>

  <h3><a name="rubytut_intro" id=
  "rubytut_intro">Introduction</a></h3>

  <p>In this step, you will analyze the program in sections. Ensure
  that line numbers are enabled in Komodo (<strong>View|View Line
  Numbers</strong>) and that the file <em>menagerie.rb</em> is
  displayed in the Komodo editor.</p>

  <h4>Line 6 - Importing the YAML class</h4>

  <ul>
    <li>This line loads Ruby's core YAML class.</li>
  </ul>

  <table align="center">
    <tbody>
      <tr>
        <td class="startupBox">
          <p><strong>Komodo Tip</strong>: Notice that syntax
          elements are displayed in different colors. You can
          adjust the display options for language elements in the
          <a class="doc" href=
          "../prefs.html#prefs_top">Preferences</a>
          dialog box.</p>
        </td>
      </tr>
    </tbody>
  </table>

  <h4>Line 8 to 13 - Define and Initialize the Entry class</h4>

  <p>The <strong>Entry</strong> class contains variables which hold
  data for individual entries in our simple database, and the
  behavior of that data. Information about each animal in our
  menagerie will be contained in an Entry class object.</p>

  <ul>
    <li><code>class Entry</code> declares the class</li>

    <li>the <strong>initialize</strong> method sets the instance
    variables <code>@sci_name</code>, <code>@desc</code>, and
    <code>@time_mod</code>.</li>
  </ul>

  <p>These variables need to be private (<em>instance</em>
  variables) rather than global because there will be an instance
  of the Entry class for each animal in the menagerie.</p>

  <h4>Line 15 - Expose instance variables</h4>

  <ul>
    <li><strong>attr_reader</strong> is a Ruby shortcut for
    exposing <code>@sci_name</code>, <code>@desc</code>, and
    <code>@time_mod</code> as read-only attributes of the Entry
    class.</li>
  </ul>

  <h4>Line 18 to 26 - Data Storage Methods</h4>

  <ul>
    <li>the <strong>sci_name=</strong> method ensures that
    <code>@time_mod</code> is updated with the current time
    whenever <code>@sci_name</code> is updated.</li>

    <li>the <strong>desc=</strong> method does the same thing for
    <code>@desc</code>.</li>
  </ul>

  <table align="center">
    <tr>
      <td class="startupBox">
        <p><strong>Komodo Tip</strong>: Click on the minus symbol
        to the left of line 18. The section of code for the
        <strong>sci_name</strong> method is collapsed. Doing this
        at line 8 collapses the entire <strong>Entry</strong>
        class. This is called <a class="doc" href=
        "../editor.html#Folding">Code Folding</a>.</p>
      </td>
    </tr>
  </table>

  <h4>Line 28 to 35 - Data Behavior Methods</h4>

  <ul>
    <li>the <strong>contains?</strong> method lets the
    <strong>cmd_search</strong> method determine if a particular
    entry contains the string the user entered (see line 82).</li>

    <li>the <strong>to_sci</strong> method returns the scientific
    name and description of an entry (see lines 77 and 83).</li>
    <!-- XXX needs further explanation -->
  </ul>

  <h4>Line 39 to 46 - Command Help</h4>

  <ul>
    <li>the <strong>$help</strong> global variable contains a
    string with information on command usage, providing an easy way
    for methods to display help information when needed.</li>
  </ul>

  <h4>Line 48 to 55 - Define and Initialize the Menagerie
  class</h4>

  <p>The <strong>Menagerie</strong> class contains the
  <strong>@menagerie</strong> hash: the container which holds the
  multiple instances of the <strong>Entry</strong> class. It also
  contains all the methods available to the user of the application
  (via the command interface starting at line 154.</p>

  <ul>
    <li><code>class Menagerie</code> declares the class</li>

    <li><strong>initialize</strong> sets the instance variables
    <code>@menagerie</code> and <code>@fname</code>.</li>
  </ul>

  <p>The name of the animal is stored as a key in the
  <code>@menagerie</code> hash. It references the
  <strong>Entry</strong> object which contains the rest of the
  information, namely the scientific name (<code>sci_name</code>)
  and description (<code>descr</code>). All the information we
  store on each animal is kept in two separate areas -- the
  <code>@menagerie</code> key and the <strong>Entry</strong> it
  points to.</p>

  <h4>Line 57 to 69 - Adding Entries</h4>

  <ul>
    <li>the <strong>split</strong> method (from Ruby's String
    class) allows us to enter an entire record in one line,
    specifying the separator character we intend to use</li>

    <li>line 60 checks for an existing entry of the same name</li>

    <li>if none is found, a new entry (i.e. Entry.new) is
    added</li>

    <li>if there is an existing key of the same name, the entry is
    only updated if there is a change to <code>sci_name</code> or
    <code>descr</code> (or both)</li>
  </ul>

  <table align="center">
    <tbody>
      <tr>
        <td class="startupBox">
          <p><strong>Exercise</strong>: After completing the
          tutorial, come back to this section and try writing a
          more "user friendly" version of this
          <strong>cmd_add</strong> method which asks for the name,
          scientific name and description separately (i.e. one at a
          time).</p>
        </td>
      </tr>
    </tbody>
  </table>

  <h4>Line 74 to 88 - Searching for Entries</h4>

  <ul>
    <li>line 75 checks to make sure an argument has been
    provided</li>

    <li>line 76 searches <code>@menagerie</code>'s key for a
    match</li>

    <li>if there is a matching key, line 77 returns the result
    using the <strong>to_sci</strong> method from the
    <strong>Entry</strong> class</li>
  </ul>

  <h4>Line 90 to 98 - Deleting Entries</h4>

  <ul>
    <li>line 91 checks to make sure an argument (<code>name</code>)
    has been given</li>

    <li>line 92 checks if the name given matches a key in
    <code>@menagerie</code></li>

    <li>if the name matches the <code>delete</code> method removes
    the entry</li>
  </ul>

  <h4>Line 100 to 102 - Listing Entries</h4>

  <ul>
    <li>line 100 specifies that the argument for
    <strong>cmd_list</strong> is called "not_used" - a placeholder
    argument name which tells us that the method will not actually
    use the argument</li>

    <li>line 101 calls the <code>dump</code> method of the
    <strong>YAML</strong> class (see line 6) to show the entire
    Menagerie object in YAML format</li>
  </ul>

  <h4>Line 104 to 133 - Saving to a File</h4>

  <ul>
    <li>line 105 to 112: checks if the first character of the
    <code>fname</code> argument is "!"; this sets the
    <code>overwrite</code> variable which determines whether
    <strong>cmd_save</strong> can overwrite an existing file</li>

    <li>line 115 to 117: if <code>overwrite</code> is false and the
    specified file exists, warn the user with a helpful
    message.</li>

    <li>line 118 to 122: if the <code>fname</code> argument exists,
    set the <code>@fname</code> instance variable, if not, prompt
    the user with a useful error message.</li>

    <li>line 123 to 126 uses ruby's <strong>File</strong> class to
    open the file for writing</li>

    <li>a file descriptor (<code>fd</code>) is created on line 124
    which is written to in the next line (a YAML dump of our
    menagerie)</li>

    <li>line 127 to 131 provides error handling for problems during
    the save</li>
  </ul>

  <h4>Line 135 to 143 - Loading from a File</h4>

  <ul>
    <li>line 136 assigns the method's argument to an instance
    variable</li>

    <li>line 138 loads the data using the <strong>YAML</strong>
    class's <strong>load_data</strong> method</li>

    <li>line 139 to 141 provides error handling for problems during
    loading</li>
  </ul>

  <h4>Line 145 to 149 - Showing Help</h4>

  <ul>
    <li>prints the <strong>$help</strong> variable (see line
    39)</li>
  </ul>

  <h4>Line 151 - Starting the Program</h4>

  <ul>
    <li>creates a new instance of the <strong>Menagerie</strong>
    class called <code>obj</code></li>
  </ul>

  <h4>Line 153 to 180 - Handling Commands from the User</h4>

  <p>The program needs a way to handle input from the user. This
  section deals with parsing input and splitting it into commands
  which call methods in the Menagerie class, and arguments for
  those methods.</p>

  <ul>
    <li>line 153 compiles a regular expression into the
    <code>cmd_re</code> variable</li>

    <li>line 154 prints the list of available commands (see line
    39)</li>

    <li>line 156 prompts the user for a command</li>

    <li>line 159 captures user input and saves it to the
    <code>cmdline</code> variable</li>

    <li>the if block beginning at line 160 matches the user input
    against <code>cmd_re</code></li>

    <li>this regular expression captures the first word "(\w+)" and
    the word that follows it "(.*)"</li>

    <li>the input is split into two parts:</li>

    <li style="list-style: none">
      <ul>
        <li>the first word has the string "cmd_" prepended to it,
        and is then assigned to the <code>cmd</code> variable</li>

        <li>the second word, or words, are assumed to be arguments
        and assigned to the <code>args</code> variable</li>
      </ul>
    </li>

    <li>line 163 checks if <code>cmd</code> is a valid method in
    the Menagerie class.</li>

    <li style="list-style: none">
      <ul>
        <li>if it is, cmd and args are passed to the current
        Menagerie object using the <strong>send</strong> method
        (inherited from Ruby's <strong>Object</strong> class)</li>

        <li>if the command is "quit" the program is ended with a
        <code>break</code></li>

        <li>if neither, an error message is passed to the user</li>
      </ul>
    </li>

    <li>if the cmd_re regular expression cannot parse the command,
    line 177 prints an error message refering the user to the
    'help' command</li>
  </ul>

  <h2><a name="rubytut_run" id="rubytut_run">Running the
  Program</a></h2>

  <p>In this step you will run the program and interact with
  it.</p>

  <ol>
    <li>To run <strong>menagerie.rb</strong> without debugging:
    Select <strong>Debug|Go/Continue</strong>. The program
    interface displays in the <strong>Command Output</strong> tab.
    Try various commands to test the program.</li>

    <li>In the Command Output tab, enter various commands to test
    the program.</li>

    <li>Enter the following commands:</li>

    <li style="list-style: none">
      <ul>
        <li>load animals.yaml</li>

        <li>list</li>

        <li>delete Komodo dragon</li>
      </ul>
    </li>
  </ol>

  <p>The output of the last command (including "Error: undefined
  method...") indicates that something is not working correctly.
  Debugging can help trace this problem. Type <code>quit</code> in
  the <strong>Output</strong> window before starting the
  debugger.</p>

  <h2><a name="rubytut_debug" id="rubytut_debug">Debugging the
  Program</a></h2>

  <p>In this step you will add breakpoints to the program and
  "debug" it. Adding breakpoints lets you run the program in
  sections, making it easier to watch variables and view the output
  as it is generated.</p>

  <p>Breakpoints are used to identify exactly where a program may
  be having problems. A bug has been intentionally left in the
  <strong>cmd_delete</strong> method which can illustrate this.</p>

  <ol>
    <li><strong>Set a breakpoint</strong>: On the
    <strong>menagerie.rb</strong> tab, click on the gray margin
    immediately to the left of the code on line 93 of the program.
    This sets a breakpoint, indicated by a red circle.</li>

    <li><strong>Run the debugger</strong>: Select
    <strong>Debug|Go/Continue</strong> (or enter 'F5', or use the
    Debug Toolbar). The <a class="doc" href=
    "../debugger.html#Debugging_Options">Debugging
    Options</a> dialog box will then pop up; press the
    <strong>Return</strong> key or <strong>OK</strong> button to
    dismiss it. You can pass program options to the program with
    the <strong>Script Arguments</strong> text box, but this
    particular program doesn't take any.</li>

    <li><strong>Enter commands</strong>: In the <strong>Command
    Output</strong> tab, re-enter the commands from the <a href=
    "#rubytut_run">Running the Program</a> section ('load
    animals.yaml', 'list', and 'delete Komodo dragon').</li>
  </ol>

  <table align="center">
    <tr>
      <td class="startupBox">
        <p><strong>Komodo Tip</strong>: Debugger commands can be
        accessed from the <strong>Debug</strong> menu, by shortcut
        keys, or from the Debug Toolbar. For a summary of debugger
        commands, see the <a class="doc" href=
        "../debugger.html#How_use_Debugger">Debugger
        Command List</a>.</p>
      </td>
    </tr>
  </table>

  <ol start="4">
    <li><strong>Watch the debug process</strong>: After the last
    command, notice that a yellow arrow appears where breakpoint is
    set (line 93). This arrow indicates the position at which the
    debugger has halted. This tells us that our command did match a
    key in <code>@menagerie</code>.</li>

    <li><strong>Check the relevant variables</strong>: Click on the
    <strong>Self</strong> tab to see the current object's instance
    and class variables. Notice the <code>@menagerie</code> hash.
    Expand the view of the hash by clicking the plus symbol next to
    it. It should only contain the "Leopard gecko" entry after the
    "Komodo dragon" entry has been deleted.</li>

    <li><strong>Set a Watch variable</strong>: Select the
    <strong>Watch</strong> tab of the debugger window, highlight
    '<code>@menagerie.has_key?(name))</code>' on line 92 and drag
    it into the <strong>Watch</strong> tab. You can place most
    valid Ruby expressions in this area, including assignments,
    whether they're in the program or not. For example, placing the
    expression '<code>x = 2 + 2</code>' in the Watch tab will show
    that a local variable called 'x' is set to 4.</li>
  </ol>

  <table align="center">
    <tr>
      <td class="startupBox">
        <p><strong>Komodo Tip</strong>: What do the debugger
        commands do?</p>

        <ul>
          <li><strong>Step In</strong>: Executes the current line
          of code and pauses at the following line.</li>

          <li><strong>Step Over</strong>: Executes the current line
          of code. If the line of code calls a function or method,
          the function or method is executed in the background and
          the debugger pauses at the line that follows the original
          line.</li>

          <li><strong>Step Out</strong>: When the debugger is
          within a function or method, Step Out executes the code
          without stepping through the code line-by-line. The
          debugger stops on the line of code following the function
          or method call in the calling program.</li>
        </ul>
      </td>
    </tr>
  </table>

  <ol start="6">
    <li><strong>Step In</strong>: Select <strong>Debug|Step
    In</strong> until the debugger stops at line 166 (print
    status_message). "Step In" is a debugger command that causes
    the debugger to enter a function called from the current
    line.</li><!-- XXX leave out till we can use an example from menagerie.rb
 <li><strong>Step Out</strong>: The debugger also handles cases where
 arguments of a function call additional functions For example, suppose
 you want to step into function g at the line:
<pre class="code">
g(f1(), f2())
</pre>
 <strong>Step-into</strong> will put you at the first line of function
 f1.  At that point, clicking <strong>Step-Out</strong> will take you to
 the first line of f2.  Clicking <strong>Step-Out</strong> there will
 take you to the first line of g.  This kind of stepping is difficult to
 do in many other debuggers without resorting to setting a breakpoint at
 the first line of g (for example).</li> -->

    <li><strong>View local variable</strong>: On the
    <strong>Debug</strong> tab, click the <strong>Locals</strong>
    tab. Examine the <code>status_message</code> variable. This
    variable contains the message that will be returned to the
    user.</li>

    <li><strong>Run the debugger</strong>: Select
    <strong>Debug|Go/Continue</strong> (or enter 'F5', or use the
    Debug Toolbar). The command returns
    "<code>#&lt;Entry:0x83096f8&gt;Error: undefined method `[]' for
    #&lt;Entry:0x83096f8&gt;</code>" which is not a very
    user-friendly message. The <strong>cmd_delete</strong> method
    is missing an explicit <code>return</code> value to provide if
    the deletion was successful.</li>

    <li><strong>Fix the problem</strong>: On the
    <strong>Debug</strong> menu, click <strong>Stop</strong> (or
    use the Stop button on the Debug Toolbar). Uncomment line 94 by
    removing the "#".</li>

    <li><strong>Disable and Delete a breakpoint</strong>: Click on
    the red breakpoint at line 93. The red breakpoint is now white
    with a red outline. This breakpoint is now disabled. Click on
    the disabled white breakpoint. This removes the
    breakpoint.</li>

    <li><strong>Run the debugger</strong>: Select
    <strong>Debug|Go/Continue</strong> and re-run the commands used
    previously ('load animals.yaml', 'list', and 'delete Komodo
    dragon'). The 'delete' command now returns the message
    "Deleted".</li>
  </ol>

  <h2><a name="rubytut_resources" id="rubytut_resources">More Ruby
  Resources</a></h2>

  <h3>Tutorials and Reference Sites</h3>

  <p>There are many Ruby tutorials and beginner Ruby sites on the
  Internet, including:</p>

  <ul>
    <li><a class="doc" target="_blank" href=
    "http://ruby-lang.org">ruby-lang.org</a>: The main page for the
    ruby language, including release notes and downloads.</li>

    <li><a class="doc" target="_blank" href=
    "http://ruby-doc.org">ruby-doc.org</a>: Extensive online
    documentation including tutorials and links, with well
    organized core and standard library API documentation.</li>

    <li><a class="doc" target="_blank" href=
    "http://www.ruby-doc.org/docs/ProgrammingRuby/">Programming
    Ruby</a>: Tutorial and reference.</li>

    <li><a class="doc" target="_blank" href=
    "http://poignantguide.net/ruby/">why's (poignant) guide to
    ruby</a>: An entertaining introduction to Ruby.</li>

    <li><a class="doc" target="_blank" href=
    "http://pine.fm/LearnToProgram/">Learn to Program</a>:
    Excellent Ruby tutorials for beginners by Chris Pine.</li>

    <li><a class="doc" target="_blank" href=
    "http://documentation.rubyonrails.com/">Ruby on Rails -
    Documentation</a>: Documentation and tutorials for the
    <strong>Ruby on Rails</strong> web development framework.</li>
  </ul>
  <hr />

</div> <!-- content -->
</body>
</html>

<!-- Copyright (c) 2000-2006 ActiveState Software Inc. -->
<!-- See the file LICENSE.txt for licensing information. -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux (vers 1 September 2005), see www.w3.org" />
  <link rel="stylesheet" type="text/css" href="css/screen.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="favicon.ico" type=
  "image/x-icon" />

  <title>Macros</title>
</head>

<body>
  <h1><a name="macros_top" id="macros_top">Macros</a></h1>

  <p>A macro consists of keystroke sequences that are recorded,
  saved, and executed either manually, via a key binding, or with
  an event <a class="doc" href="#triggers_macros">trigger</a>. When
  the macro is invoked, the recorded keystrokes and instructions
  execute. Only keystrokes (not mouse movements) are recorded
  within macros. Note that, with the exception of the Find dialog
  box, macros that call external dialog boxes are not supported.
  Macros are stored in <a class="doc" href=
  "project.html#project_top">projects</a> or the
  <a class="doc" href=
  "toolbox.html#toolbox_top">Toolbox</a>. <a class="doc"
  href="prefs.html#Config_Key_Bindings">Custom key
  bindings</a> can be assigned to macros.</p>

  <p>The <strong>Macros</strong> toolbar provides quick access for
  recording, running, and saving macros. To open or close the
  toolbar, select <strong>View|Toolbars|Macros</strong>.
  Alternatively, select <strong>Tools|Macros</strong>.</p>

  <h2><a name="creating_macros" id="creating_macros">Creating
  Macros</a></h2>

  <p>Macros can be created via recording keystrokes, or by
  programming macro commands in the Macros properties dialog. For
  information about programming macros, refer to the <a href=
  "macroapi.html#macroapi_top">Macro API</a>.</p>

  <h3><a name="macros_adding" id="macros_adding">Recording
  Macros</a></h3>

  <p>Recording is a simple method for creating a macro. Recording a
  macro requires typing a series of keystrokes in the Editor Pane.
  To record a macro:</p>

  <ol>
    <li>Select <strong>Tools|Macros|Start Recording</strong>. The
    Komodo status bar displays "Recording Macro".</li>

    <li>In the Editor Pane, enter the keystrokes to store in the
    macro. While entering keystrokes, pause recording by selecting
    <strong>Tools|Macros|Pause Recording</strong>. Select
    <strong>Start Recording</strong> when ready to resume macro
    creation.</li>

    <li>To end macro recording, select <strong>Tools|Macros|Stop
    Recording</strong>. The status bar displays "Macro
    Recorded".</li>
  </ol>

  <p>Alternatively, use the Macros Toolbar to invoke the
  commands.</p>

  <h3><a name="macros_saving_macros" id=
  "macros_saving_macros">Saving Recorded Macros</a></h3>

  <p>To save the most recent macro:</p>

  <ol>
    <li>Select <strong>Tools|Macros|Save to Toolbox</strong>, or
    click <strong>Macro: Save to Toolbox</strong> on the Macro
    Toolbar.</li>

    <li>Give the new macro a unique name in the <strong>Enter name
    for new macro</strong> field. A reference to the macro is
    automatically added to the <a class="doc" href=
    "toolbox.html#toolbox_top">Toolbox</a>.</li>
  </ol>

  <h3><a name="macros_adding_macros" id=
  "macros_adding_macros">Programming Macros</a></h3>

  <p>Use the "New Macro" Properties dialog box to program macros in
  either Python or JavaScript. Additionally, use this dialog box to
  specify macro <a class="doc" href="#key_bindings">key
  bindings</a> and Komodo <a class="doc" href=
  "#triggers_macros">triggers</a> that invoke the macro
  automatically.</p>

  <p>To add a macro:</p>

  <ol>
    <li>Select <strong>Toolbox|Add|New Macro...</strong> or
    <strong>Project|Add|New Macro...</strong>. Alternatively, use
    the Add buttons within the Project or Toolbox tab, or
    right-click a project or folder name and select
    <strong>Add</strong>.</li>

    <li>On the <strong>Macro</strong> tab, configure the following
    options:</li>

    <li style="list-style: none">
      <ul>
        <li><strong>New Macro</strong>: Enter the name of the macro
        (displayed in the Toolbox and Projects tab) in the
        field.</li>

        <li><strong>Change Icon</strong>: Click to select a custom
        icon to associate with this macro.</li>

        <li><strong>Reset</strong>: Clears the icon choice.</li>

        <li><strong>Language</strong>: Specify the language (Python
        or JavaScript) in which to program the macro.</li>
      </ul>
    </li>

    <li>Program the macro in the <strong>Language</strong> editor
    field.</li>

    <li>Click <strong>OK</strong>.</li>
  </ol>

  <p>Refer to the <a href=
  "macroapi.html#macroapi_top">Macro API</a> for
  information about programming macros.</p>

  <h2><a name="macros_using" id="macros_using">Running
  Macros</a></h2>

  <p>To run the most recently recorded macro, select
  <strong>Tools|Macros|Execute Last Macro</strong>, or use the
  associated <a href=
  "prefs.html#Config_Key_Bindings">key binding</a>. If
  the Macro Toolbar is open (<strong>View|Toolbars|Macro</strong>),
  click <strong>Macro: Run Last Macro</strong>.</p>

  <p>To run a macro that has been saved to a file and assigned to a
  <a href="project.html#project_top">project</a> or to
  the <a href="toolbox.html#toolbox_top">Toolbox</a>,
  double-click the macro, or use the key binding assigned to the
  macro. Alternatively, right-click the macro in the Projects tab
  or the Toolbox and select <strong>Execute Macro</strong> from the
  context menu.</p>

  <h2><a name="triggers_macros" id="triggers_macros">Specifying
  Macro Triggers</a></h2>

  <p>Macros can be configured to execute based on certain Komodo
  events or triggers. When an event occurs (for example, a file is
  opened in Komodo), the macro is triggered and then executes. A
  macro that triggers "editor" functions or modifies open files
  should run in the foreground to block user access to the editor.
  Macros running in the foreground run and "block" until they
  return. This prevents the user from moving the cursor and
  disrupting the macro currently in progress.</p>

  <p><strong>Macro Return Values</strong></p>

  <p>Use the Macros Properties dialog box to specify a macro return
  value. Entering <code>return 1;</code> is syntactically valid as
  a true value in either Python or JavaScript. Macros that return
  true and invoke <em>before</em> a Komodo event can interrupt the
  process under execution. For example, a macro can prevent a file
  from being saved if true is returned. If a macro returns "None"
  in JavaScript, or "Null" in Python, it evaluates to false and
  does not interrupt the Komodo event in progress.</p>

  <p><strong>Note</strong>: Be sure to enable macro triggers via
  the <a href="prefs.html#projects">Projects and
  Workspace Preferences</a> in Komodo's preferences. In the
  <strong>Triggering Macros</strong> area, select <strong>Enable
  triggering of macros on Komodo events</strong>, and then click
  <strong>OK</strong>.</p>

  <p>To add a trigger to a macro:</p>

  <ol>
    <li>Right-click the macro in the Toolbox and select
    <strong>Properties</strong>.</li>

    <li>Select the <strong>Triggers</strong> tab on the Macro
    Properties dialog box to access the following options:</li>

    <li style="list-style: none">
      <ul>
        <li><strong>Macro should trigger on a Komodo
        event</strong>: Select the check box to access the trigger
        events.</li>

        <li>Select the event you want to trigger the macro:</li>

        <li style="list-style: none">
          <ul>
            <li><strong>At the tail end of the Komodo startup
            process</strong></li>

            <li><strong>After a file is opened</strong></li>

            <li><strong>Before a file is saved</strong></li>

            <li><strong>After a file is saved</strong></li>

            <li><strong>Before a file is closed</strong></li>

            <li><strong>After a file is closed</strong></li>

            <li><strong>Before Komodo shuts down (as part of
            File/Exit)</strong></li>
          </ul>
        </li>

        <li><strong>Rank</strong>: Enter a numerical rank for the
        macro. For example, if three macros all invoke "After a
        file is opened", a macro executes first (100), second
        (101), or third (102). The default is 100 to provide room
        for macros to run before the default (1-99). Note that if
        two macros trigger on the same event with the same rank,
        both execute in indeterminate order.</li>
      </ul>
    </li>

    <li>Click <strong>Apply</strong>.</li>
  </ol>

  <h3><a name="run_background" id="run_background">Running Macros
  in the Background</a></h3>

  <p>If a macro is not associated with a Komodo event, it can run
  either in the foreground or in the background. Depending on the
  use case, some macros should run in the background while others
  are more suitable for running in the foreground. Macros that
  invoke and do not affect the current file are best run in the
  background to minimize interference with Komodo responsiveness.
  Macros that perform "editor" functions or modify open files
  should always run in the foreground to "block" and prevent user
  interference. This prevents the user from moving the cursor and
  disrupting the macro currently in progress. Macros that run in
  the background are run in threads in Python, or in a timeout in
  JavaScript.</p>

  <p>To run a macro in the background:</p>

  <ol>
    <li>Right-click the macro in the Toolbox and select
    <strong>Properties</strong>.</li>

    <li>Select the <strong>Run in Background</strong> option.</li>

    <li>Click <strong>Apply</strong>.</li>
  </ol>

  <h2><a name="assign" id="assign">Storing Macros in Projects or
  the Toolbox</a></h2>

  <p>Macros are added to the <a href=
  "toolbox.html#toolbox_top">Toolbox</a> via the
  <strong>Tools|Macros|Save to Toolbox</strong> option. However,
  you can manually add macros to the Toolbox, or to a project in
  the <a class="doc" href=
  "project.html#project_top">Projects tab</a>.</p>

  <p>To add a new macro to a project or the Toolbox:</p>

  <ol>
    <li>Right-click the name of the project, or the name of a
    folder within a project or the Toolbox, and select
    <strong>Add|New Macro</strong> from the context menu.
    Alternatively, select <strong>Project|Add|New Macro</strong> or
    <strong>Toolbox|Add|New Macro</strong> from the drop-down menu,
    or select <strong>New Macro</strong> from the Add button in the
    Project or Toolbox tab.</li>

    <li>Follow the instructions in the <a href=
    "#macros_adding_macros">Programming Macros</a> section.</li>

    <li>Click <strong>OK</strong>.</li>
  </ol>

  <p>Alternatively, existing macros can be dragged and dropped
  between the Toolbox and the Projects tab.</p>

  <h3><a name="macros_options" id="macros_options">Macro
  Options</a></h3>

  <p>To access macro options, right-click the macro name in a
  <a href="project.html#project_top">project</a> or the
  <a href="toolbox.html#toolbox_top">Toolbox</a> and
  select the desired option.</p>

  <ul>
    <li><strong>Execute Macro</strong>: Use this option to run the
    selected macro.</li>

    <li><strong>Cut/Copy/Paste</strong>: These options are used to
    remove the macro from a project or the Toolbox, or to move
    macros between the project and the Toolbox (and vice
    versa).</li>

    <li><strong>Export as Project File</strong>: When this option
    is invoked, a new project file is created that contains the
    macro from which the option is invoked. You are prompted to
    provide the name of the new project file and the directory
    where it will be stored. To open the new project file, select
    <strong>File|Open|Project</strong>.</li>

    <li><strong>Export Package</strong>: Macros can be archived and
    distributed among multiple Komodo users via "packages".
    Packages are compressed archive files that contain the macro
    from which the <strong>Export Package</strong> option was
    invoked. Packages are stored in files with a ".kpz" extension,
    and can be opened by any archiving utility that supports
    <code>libz</code> (for example WinZip). The <strong>Export
    Package</strong> option differs from the <strong>Export as
    Project File</strong> option in that copies of filesystem-based
    components (such as files and dialog projects) are included in
    the archive. Conversely, <strong>Export as Project
    File</strong> creates a project with a reference to the
    component's original location and does not create copies of the
    components. When <strong>Export Package</strong> is invoked,
    you are prompted for a name and file location for the package.
    Exported packages can only be imported into "container" objects
    in Komodo, such as projects, the Toolbox, and folders within
    projects and the Toolbox. See <a href=
    "toolbox.html#export_import">Toolbox - Exporting and
    Importing Toolbox Contents</a>, <a href=
    "project.html#project_impexp">Projects - Importing
    and Exporting Projects via Packages</a>, <a href=
    "folders.html#folders_importpack">Folders - Import
    Contents from Package</a> for more information.</li>

    <li><strong>Rename</strong>: To change the name of a macro,
    select this option and enter a new name.</li>

    <li><strong>Delete</strong>: To remove a macro from a project
    or the Toolbox, select this option. The macro is permanently
    deleted.</li>
  </ul>

  <h3><a name="Cust_Icons" id="Cust_Icons">Assigning Custom Icons
  to Macros</a></h3>

  <p>The default macro icon can be replaced with custom icons.
  Komodo includes more than 600 icons; alternatively, select a
  custom image stored on a local or network drive (use 16x16-pixel
  images for best results).</p>

  <p>To assign a custom icon to a macro:</p>

  <ol>
    <li>In the <a href=
    "project.html#project_top">project</a> or in the
    <a href="toolbox.html#toolbox_top">Toolbox</a>,
    right-click the desired macro and select
    <strong>Properties</strong>. Alternatively, click the macro in
    the Projects tab or Toolbox tab, then select
    <strong>Projects|<em>macro_name</em>|Properties</strong> or
    <strong>Toolbox<em>macro_name</em>|Properties</strong>.</li>

    <li>In the Properties dialog box, click <strong>Change
    Icon</strong>.</li>

    <li>In the Pick an Icon dialog box, select a new icon and click
    <strong>OK</strong>. Alternatively, click <strong>Choose
    Other</strong>, and browse to the desired image file.</li>

    <li>In the properties dialog box for the macro, click
    <strong>OK</strong>. The custom icon is displayed next to the
    macro.</li>
  </ol>

  <p>To revert to the default icon for a selected macro:</p>

  <ol>
    <li>On the Projects tab or Toolbox tab, right-click the desired
    macro and select <strong>Properties</strong>.</li>

    <li>Click <strong>Reset</strong>, then click
    <strong>OK</strong>. The default icon is displayed next to the
    macro.</li>
  </ol>

  <h3><a name="key_bindings" id="key_bindings">Assigning Key
  Bindings to Macros</a></h3>

  <p>Custom key bindings can be assigned to macros stored in the
  <a href="toolbox.html#toolbox_top">Toolbox</a> or in a
  <a href="project.html#project_top">Project</a>. Use
  the <strong>Key Binding</strong> tab in the macro's Properties to
  specify the keystrokes that invoke the macro. See <a href=
  "prefs.html#Config_Key_Bindings">Key Bindings for
  Custom Components</a> for more information.</p>

  <h3><a name="vi_macros" id="vi_macros">Vi Command Mode
  Macros</a></h3>

  <p>Komodo's <a href="vikeybind.html#vi_emulation">Vi
  emulation</a> offers a command-line mode. Entering
  '<strong>:</strong>' opens a text box for entering commands. You
  can add additional commands by creating a <a href=
  "toolbox.html">Toolbox</a> folder named <strong>Vi
  Commands</strong>, then creating <a href=
  "macros.html">Macros</a> with the name of the desired
  command. The macro is executed when you type it's name in the Vi
  command text box. For example, to create a macro that replicates
  the behavior of the 'ZZ' command in Vi:</p>

  <ol>
    <li>record or write a macro that saves and closes the current
    file</li>

    <li>save the macro to the Toolbox with the name 'ZZ'</li>

    <li>move the ZZ macro into the Vi Commands folder.</li>
  </ol>
  <hr />
</body>
</html>

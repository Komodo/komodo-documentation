<!-- Copyright (c) 2000-2006 ActiveState Software Inc. -->
<!-- See the file LICENSE.txt for licensing information. -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux (vers 1 September 2005), see www.w3.org" />
  <link rel="stylesheet" type="text/css" href="css/screen.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="favicon.ico" type=
  "image/x-icon" />

  <title>Debugging JavaScript</title>
</head>

<body>
  <h1><a name="debugjs_top" id="debugjs_top">Debugging
  JavaScript</a> <span class="version_alert">Komodo IDE
  only</span></h1>

  <div class="right-float-box">
    <p><strong>Tutorial</strong></p>

    <ul>
      <li><a href="tutorial/jstut.html#jstut_top">JavaScript
      Tutorial</a></li>
    </ul>
  </div>

  <p>Komodo can debug local or remote JavaScript programs. Unlike
  other dynamic language debugging, Komodo uses uses the <a href=
  "http://www.mozilla.com/firefox/">Firefox</a> browser as its
  JavaScript runtime environment. JavaScript enabled pages are
  loaded, viewed and controlled in Firefox, and the debugging
  information is passed to Komodo via the <strong>Komodo JavaScript
  Debugger</strong> extension.</p>

  <p>The instructions below describe how JavaScript debugging works
  in Komodo, and how to configure Komodo and Firefox for debugging.
  For general information about using the Komodo debugger, see
  <a class="doc" href=
  "debugger.html#debugger_top">Komodo Debugger
  Functions</a>.</p>

  <h2><a name="Understanding_JavaScript_Debugging" id=
  "Understanding_JavaScript_Debugging">Understanding JavaScript
  Debugging</a></h2>

  <p>JavaScript debugging using Firefox and Komodo is different in
  a few important ways from debugging in other languages. As
  JavaScript programs are generally run and controlled from a
  browser window, limitations in the browser's JavaScript library
  (in this case, Mozilla's jsLib) affect how code is handled in the
  debugging process.</p>

  <h3><a name="JavaScript_Pretty_Print" id=
  "JavaScript_Pretty_Print">Pretty Print</a></h3>

  <p>In certain situations, the JavaScript library returns compiled
  code objects rather than the original JavaScript source. Komodo
  is unable to display meaningful information without decompiling
  and visually reformatting the code object first. This view of the
  code object is called <strong>Pretty Print</strong>.</p>

  <p>The <strong>Pretty Print</strong> Debug toolbar button and
  menu option allows for manual toggling of this view. This option
  is important in two cases:</p>

  <ul>
    <li>
      <p><strong>JavaScript in an HTML element</strong>: When
      JavaScript is used within an HTML element, the Komodo
      JavaScript Debugger currently returns a code object without
      the HTML context. For example:</p>
      <pre class="code">
&lt;p&gt;&lt;a onclick="javascript:alert('This is an alert!');"&gt;Click me.&lt;/a&gt;&lt;p&gt;
</pre>

      <p>If this construct were on line 200 of an HTML file, the
      debugger would not open the HTML file at line 200, but
      automatically display the following in Pretty Print mode:</p>
      <pre class="code">
function onclick(event) {
javascript:
   alert("This is an alert!");
}
</pre>
    </li>

    <li>
      <p><strong>eval()</strong>: As JavaScript does not have a
      'use' statement to pull in modules, <code>eval()</code> is
      often used to dynamically load JavaScript code (common in
      various JavaScript web toolkits). When stepping through the
      contents of an <code>eval()</code> it will often be helpful
      to switch to Pretty Print mode.</p>

      <p>In the following example the string being evaluated is
      actually JavaScript code defined in the <code>code</code>
      variable.</p>
      <pre class="code">
&lt;script language="javascript" type="text/javascript"&gt;
  var code = "var i = 1; \n" +
  "var j = 2; \n" +
  "alert('i + j = ' + (i + j)); \n";

  function runIt() {
     eval(code);
     }

  runIt();
&lt;/script&gt;
</pre>

      <p>When stepping through this code in normal mode, Komodo
      will spend several extra steps on the <code>eval(code)</code>
      line without jumping up to the embedded code in the <code>var
      code</code> section. In more complex JavaScript, or in
      <code>eval()</code> instances that call external files or
      dynamically generated code, this would be quite
      uninformative.</p>

      <p>In Pretty Print mode, the code objects are returned
      individually, each in a new editor tab, as you step through
      the code. When the <code>eval(code)</code> line is
      encountered, a new tab will open up displaying the embedded
      JavaScript from the <code>var code</code> section.</p>
    </li>
  </ul>

  <p>When debugging these JavaScript constructs, you may find that
  the line numbers displayed in the <strong>Call Stack</strong> are
  wrong, sometimes even specifying a line number beyond the last
  line of the file. This is a side-effect of the JavaScript library
  constraints mentioned earlier, and an indicator that you should
  switch to Pretty Print mode (if Komodo has not done this
  automatically).</p>

  <h2><a name="Configure_JavaScript_Debugging" id=
  "Configure_JavaScript_Debugging">Configuring the JavaScript
  Debugger</a></h2>

  <ol>
    <li>If you have not already done so, download and install the
    <a href="http://www.mozilla.com/firefox/">Firefox</a> browser
    for your operating system / platform.</li>

    <li>In Komodo, on the <strong>Edit</strong> menu, click
    Preferences</li>

    <li>In the Preferences dialog box under
    <strong>Languages</strong>, click
    <strong>JavaScript</strong>.</li>

    <li>Click <strong>Install/Upgrade 'Komodo JavaScript Debugger'
    Firefox extension</strong>.</li>

    <li>Follow the steps in the Firefox <strong>Software
    Installation</strong> dialog box to install
    <strong>jslib.xpi</strong> and
    <strong>komodo_javascript_debugger.xpi</strong>.</li>
  </ol>

  <p>Alternatively, launch Firefox and navigate to the
  <em>/lib/support/modules/</em> subdirectory of your Komodo
  installation and open the xpi files.</p>

  <p>Once these extensions have been installed, the Komodo JavaScript Debugger
  extension must be configured to communicate with Komodo. In Firefox, click
  <strong>Tools</strong> | <strong>Komodo JavaScript Debugger</strong> |
  <strong>Options</strong>.</p>

  <p>The following configuration options are available:</p>

  <ul>
    <li><strong>Host</strong>: This is set to 127.0.0.1 (localhost)
    by default and should not normally need to be changed. If
    Firefox is running on a different host, or if you are using a
    <a href="debugger.html#dbgp_proxy">DBGP Proxy</a>,
    set the appropriate IP address here.</li>

    <li><strong>Port</strong>: This should be set to the same value
    that is set in Komodo's <a href=
    "prefs.html#Debugger">Debugger preferences</a>. This
    port setting can also be checked by clicking
    <strong>Debug</strong> | <strong>Listener Status</strong>.</li>

    <li><strong>Use Proxy</strong>: Select this option if you are
    connecting to Komodo via a <a href=
    "debugger.html#dbgp_proxy">DBGP Proxy</a>.</li>

    <li><strong>Proxy Key</strong>: If <strong>Use Proxy</strong>
    is selected, this should be set to the same value configured in
    Komodo's <a href="prefs.html#Debugger">Debugger
    preferences</a>.</li>
  </ul>

  <p>When debugging JavaScript, Komodo attempts to fetch the code
  from the URI used in the browser unless otherwise specified. If
  you want to actually edit the file while debugging, you will need
  to map the URI to a local or remote filesystem directory. Specify
  these mappings in <a href=
  "prefs.html#mapped_uris">Mapped URIs</a> under
  <strong>File</strong> | <strong>Preferences...</strong>.</p>

  <h2><a name="JavaScript_Debugging" id=
  "JavaScript_Debugging">Debugging JavaScript</a></h2>

  <p>To begin a JavaScript debugging session:</p>

  <ol>
    <li>Click <strong>Debug</strong> | <strong>Listen for Debugger
    Connections</strong> in Komodo if it is not already
    selected.</li>

    <li>Open the web page or local file you wish to debug in
    Firefox.</li>

    <li>In Firefox, click <strong>Connect to Komodo
    Debugger</strong> in the Komodo JavaScript Debugger toolbar or
    click <strong>Tools</strong> | <strong>Komodo JavaScript
    Debugger</strong> | <strong>Connect to Komodo
    Debugger</strong>.</li>

    <li>In Firefox, click or mouse over a JavaScript control or, if
    your page contains one, wait for a JavaScript timer event.</li>
  </ol>

  <p>At this point the <strong>New Remote Debugger
  Connection</strong> dialog box may appear asking if you want to
  accept the debugger session. Click <strong>Yes</strong> to open
  the program in a new editor tab. Select "Don't ask me again." to
  automatically accept all remote debugging sessions in future.</p>

  <p>Breakpoints can now be set and the program can be
  interactively debugged in Komodo. See <a class="doc" href=
  "debugger.html#debugger_top">Komodo Debugger
  Functions</a> for full instructions on using Komodo's debugging
  functionality.</p><!-- Footer Start -->
  <hr />
</body>
</html>
